<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="stylesheet.css" type="text/css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
</head>

<body>
    <div id="top">
        <h1>FlickrSearch</h1>
    </div>

<section id="mainSection">

    <div id="left" ng-app="searchForm" ng-controller="searchCtrl">
         <!--   (Angular) Search bar -->
        <form ng-submit="myFunc()">
            Search for: <input type="text" ng-model="keyword">
            <input type="submit" value="Search">
        </form>

        <p>{{searchOverview}}</p>
        <ul id="searchList"> <!-- Empty search history --></ul>

        <script>
            // Variable to keep count of amount of searches \\
            var searches = 0;
            var searchLabel = "";


            var app = angular.module("searchForm", []);
            app.controller("searchCtrl", function($scope) {
                $scope.myFunc = function() {

                    if ($scope.keyword == "" || $scope.keyword == " ") return;

                    searches++; // Increment searches
                    $("li").removeClass("current");
                    newItem = "<li id='" + $scope.keyword + "' class='current'>" + $scope.keyword + "</li>"; // Create new list item using the keyword
                    $("#searchList").prepend(newItem);

                    // Appropriate label for search history
                    if (searches == 1) searchLabel = "Last search: ";
                    else searchLabel = "Last " + searches + " searches:";
                    $scope.searchOverview = searchLabel;

                    // AJAX request --- Moved here from mainpage.js
                    $.ajax('https://api.flickr.com/services/feeds/photos_public.gne',
    
                    {
                        dataType: 'jsonp',
                        // Set Tag to be the entry from the Angular searchbar
                        data: { "tags": $scope.keyword, "format": "json" }
                    });
                    // AJAX reply still handled in mainpage.js ( jsonFlickrFeed(json) )

                    $scope.keyword = ""; // Clear searchbar
                }
            });   
        </script>
    </div>

    <div id="right">
        <p id="results">This is default text</p>
        <div id="gallery"></div>
   </div>

</section>
    
    <script src="jquery-1.11.0.js"></script>
    <script src="mainpage.js"></script>
</body>

</html>